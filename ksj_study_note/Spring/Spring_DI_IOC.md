# 의존성 주입(DI)과 IoC 컨테이너

---

## 🔹 IoC (Inversion of Control)란?

IoC는 객체의 생성과 의존성 관리를 개발자가 아닌 **프레임워크가 대신 제어**하는 설계 원칙이다.  
전통적인 방식에서는 개발자가 객체를 직접 생성하고 조립했지만, IoC 환경에서는 **객체 간의 의존성 주입을 외부 시스템이 책임**진다.

Spring은 이 IoC 원칙을 구현한 프레임워크로, **IoC Container**를 통해 객체의 라이프사이클과 의존성을 관리한다.

---

## 🔹 DI (Dependency Injection)란?

DI는 IoC의 구체적인 구현 방법 중 하나로, **객체가 필요로 하는 의존성을 외부에서 주입**받는 방식이다.  
의존성을 직접 생성하지 않고, 프레임워크가 준비된 인스턴스를 자동으로 전달해준다.

---

## 🔹 DI의 이점

- **결합도 감소**: 구현체 교체가 쉬워지고 테스트 용이성 증가
- **코드 재사용성 향상**: 외부 구성에 따라 다른 객체를 주입 가능
- **유지보수성 개선**: 변경 사항이 다른 객체에 영향을 주지 않음
- **모듈화 강화**: 설정에 따라 객체 간의 관계를 명확하게 분리

---

## 🔹 IoC 컨테이너의 역할

Spring에서 IoC 컨테이너는 **ApplicationContext**를 통해 제공되며 다음 기능을 수행한다:

| 역할                          | 설명                                                      |
|-------------------------------|-------------------------------------------------------------|
| 객체 생성 및 소멸 관리         | 스프링 빈(Bean)의 라이프사이클을 자동으로 관리               |
| 의존성 주입                   | 필요한 의존 객체를 주입하여 조립                              |
| 설정 정보 로딩                | XML, 자바 설정 클래스, 어노테이션 기반 설정 처리              |
| 빈 후처리 및 AOP 적용         | 프록시 객체 생성 및 자동 감지 기능 수행                        |
| 이벤트 및 리스너 관리         | ApplicationEvent 기반의 이벤트 시스템 지원                    |

---

## 🔹 빈 등록 방식

Spring에서는 다양한 방식으로 IoC 컨테이너에 객체를 등록할 수 있다:

1. **XML 설정 방식**  
   `applicationContext.xml` 파일을 통해 Bean 정의

2. **자바 설정 클래스 방식**  
   `@Configuration`, `@Bean` 어노테이션 사용

3. **컴포넌트 스캔 방식**  
   `@Component`, `@Service`, `@Repository`, `@Controller` 등을 클래스에 선언하고  
   `@ComponentScan`으로 자동 탐색

---

## 🔹 DI 방식 비교

| DI 방식           | 설명                                           | 특징                           |
|--------------------|----------------------------------------------|--------------------------------|
| 생성자 주입         | 생성자 파라미터를 통해 의존성 전달             | 불변성 보장, 테스트 용이        |
| 필드 주입           | 멤버 변수에 직접 주입                          | 가장 간단하지만 테스트 어려움   |
| 세터(Setter) 주입   | setter 메서드를 통해 의존성 설정                | 선택적 의존성 주입에 유리       |

---

## 🔹 순환 참조와 DI 주의사항

- 생성자 주입 간에 **순환 참조(Circular Dependency)** 발생 시 애플리케이션이 실행되지 않음
- 해결 방법:
  - 구조 리팩토링
  - 일부 의존성을 지연 주입
  - setter 주입으로 전환

---

## 🔹 스프링 컨테이너 종류

| 컨테이너           | 설명                                           |
|--------------------|----------------------------------------------|
| `BeanFactory`      | 가장 기본적인 IoC 컨테이너, 지연 로딩 지원     |
| `ApplicationContext` | BeanFactory 확장, 국제화, 이벤트, AOP 등 통합 제공 |

실무에서는 거의 대부분 `ApplicationContext`를 사용한다.

---

## ✅ 정리 요약

- IoC는 객체 제어권을 프레임워크에 위임하는 설계 원칙이며, DI는 이를 실현하는 핵심 메커니즘이다.
- Spring의 IoC 컨테이너는 애플리케이션 전반의 객체 생성, 관리, 주입을 담당하여 구조적 유연성과 유지보수성을 향상시킨다.
- DI 방식은 상황에 따라 생성자, 필드, 세터 방식으로 선택 가능하며, **객체 간 결합도 최소화**와 **의존성 명확화**를 목표로 한다.
